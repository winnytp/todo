(()=>{"use strict";const e=(()=>{function e(){let e=this.getAttribute("data-name");document.querySelector(`li[data-name='${e}']`).remove()}function n(){document.getElementById("tasks-container").innerHTML="";let e=t.getProjectArrayLength();if(e)for(let n=0;n<e;n++){const e=document.getElementById("tasks-container");let i=document.createElement("div");i.classList.add("task-item"),i.setAttribute("data-index",n);let c=document.createElement("input");c.setAttribute("type","checkbox"),c.setAttribute("data-index",n),"yes"===t.getItem(n).completed&&(c.setAttribute("checked",""),i.classList.add("complete-task")),c.addEventListener("click",(e=>{let n=e.target.getAttribute("data-index");document.querySelector(`div[data-index='${n}']`).classList.toggle("complete-task"),"yes"===t.getItem(n).completed?t.getItem(n).completed="no":t.getItem(n).completed="yes",console.log("Is the item completed: "+t.getItem(n).completed)}));let o=document.createElement("p");o.textContent=t.getItem(n).title,o.setAttribute("data-index",n);let s=document.createElement("i");s.setAttribute("class","fas fa-times"),s.setAttribute("data-index",n),s.addEventListener("click",a),i.appendChild(c),i.appendChild(o),i.appendChild(s),i.addEventListener("click",(e=>d(e))),i.addEventListener("click",(()=>{let e=document.querySelector(".highlight-task");e&&e.classList.toggle("highlight-task"),i.classList.toggle("highlight-task")})),e.appendChild(i)}}function i(e,t){let n=document.querySelector(".description"),i=document.getElementById("no-task-default-view");"hide"===e&&(n.classList.add("hidden"),i.classList.remove("hidden")),"show"===e&&(n.classList.remove("hidden"),n.setAttribute("data-index-array",`${t}`),i.classList.add("hidden"))}function d(e){if("INPUT"===e.target.tagName||"I"===e.target.tagName)return;let n=e.target.getAttribute("data-index"),d=document.querySelector("textarea"),c=document.querySelector(".description-title > input");const o=document.querySelector("input[type=date]");c.value=t.getItem(n).title,i("show",n),o.setAttribute("data-index",n),t.getItem(n).description||(d.value=""),t.getItem(n).description&&(d.value=t.getItem(n).description),t.getItem(n).date||(o.value=""),t.getItem(n).date&&(o.value=t.getItem(n).date),console.log(t.getItem(n).date)}function c(){let e=t.getProjectArrayLength()-1,n=document.querySelector("textarea"),d=document.querySelector(".description-title > input");if(document.querySelector("input[type=date]").setAttribute("data-index",e),d.value=t.getItem(e).title,i("show",e),!t.getItem(e).description)return n.value="";n.value=t.getItem(e).description}function o(){document.querySelector("input[type=date]").value=""}function a(){const e=this.getAttribute("data-index");document.querySelector(`.task-item[data-index='${e}']`).remove(),t.removeItem(e),i("hide"),n()}return{addTask:function(){const e=document.getElementById("task-input");e.value&&(n(),e.value="",c(),o())},switchProject:function(e){let d=document.querySelector(".selected");const c=document.getElementById("project-name");d&&d.classList.remove("selected"),e.classList.add("selected"),c.textContent=t.getCurrentProject(),i("hide"),n(),o()},drawAllTasks:function(){n()},editTitle:function(e,t){document.querySelector(`p[data-index='${e}']`).innerText=String(t)},showLastItem:c,createProject:function(n){const i=document.querySelector("#lists-view > ul"),d=document.createElement("li");d.classList.add("project"),d.innerText=n,d.setAttribute("data-name",n),d.addEventListener("click",(e=>t.switchProject(e)));const c=document.createElement("span");c.classList.add("remove-list"),c.setAttribute("data-name",n),c.addEventListener("click",e);const o=document.createElement("i");o.setAttribute("class","fas fa-times-circle");const a=document.getElementById("new-list-input");a.value="",a.classList.toggle("hidden"),document.getElementById("new-list").classList.toggle("add-list-focus"),c.appendChild(o),d.appendChild(c),i.appendChild(d)}}})(),t=(()=>{let t={Inbox:[{title:"Welcome to Todo",description:"This is a default description, edit me!"},{title:"What can you do with Todo?",description:"This is another default description."},{title:"Check out my Github",description:"Find me @winnytp"}],"Example List":[{title:"This is an example title",description:"This is an example description"}]},n="Inbox",i=t[`${n}`];function d(e,t,n,i,d){const c={};return e&&(c.title=e),c.description=t,c.date=n,c.priority=i,c.completed=d,c}return{newTask:function(){let i=t[`${n}`];const c=document.getElementById("task-input");c.value&&(i.push(d(c.value)),console.table(i),e.addTask())},switchProject:function(d){let c=d.target;i=t[`${c.textContent}`],i&&(n=c.textContent,console.log("Switched to: "+n),console.table(i),e.switchProject(c))},addProject:function(){let n=document.getElementById("new-list-input").value;t[`${n}`]=[],console.log(t[`${n}`]),e.createProject(n)},getCurrentProject:function(){return n},getItem:function(e){return t[`${n}`][e]},getProjectArrayLength:function(){return t[`${n}`].length},createDefaultInbox:function(){let e=t.Inbox;e.push(d("Welcome to Todo","This is a default description. Edit me!")),e.push(d("What can you do with Todo?","This is another default description."))},saveDescription:function(){let e=document.querySelector(".description").getAttribute("data-index-array"),t=document.querySelector("textarea");e&&(i[e].description=t.value)},saveTitle:function(){let t=document.querySelector(".description").getAttribute("data-index-array"),n=document.querySelector(".description-title > input").value;e.editTitle(t,n),i[t].title=n},saveDate:function(){let e=this.getAttribute("data-index");const t=document.querySelector("input[type=date]");i[e].date=t.value,console.log(t.value+" was saved in "+n+" (index: "+e+")")},removeItem:function(e){i.splice(e,1)}}})();console.log("Todo App"),document.getElementById("add-task-btn").addEventListener("click",(()=>t.newTask())),document.getElementById("task-input").addEventListener("keypress",(e=>{"Enter"===e.key&&t.newTask()})),document.querySelectorAll(".project").forEach((e=>{e.addEventListener("click",(e=>t.switchProject(e)))})),document.querySelector("textarea").addEventListener("change",t.saveDescription),document.querySelector(".description-title > input").addEventListener("change",t.saveTitle),document.querySelector("input[type=date]").addEventListener("change",t.saveDate),document.getElementById("new-list").addEventListener("click",(()=>{document.getElementById("new-list-input").classList.toggle("hidden"),document.getElementById("new-list").classList.toggle("add-list-focus")})),document.getElementById("new-list-input").addEventListener("keypress",(e=>{"Enter"===e.key&&t.addProject()})),e.createProject("Example List"),e.drawAllTasks()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZXIuanMiLCJ3ZWJwYWNrOi8vdG9kby8uL3NyYy9wcm9qZWN0SGFuZGxlci5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwcm9qZWN0SGFuZGxlciBmcm9tIFwiLi9wcm9qZWN0SGFuZGxlclwiO1xuXG5jb25zdCBkaXNwbGF5Q29udHJvbGxlciA9ICgoKSA9PiB7XG4gICAgZnVuY3Rpb24gYWRkVGFzaygpIHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFzay1pbnB1dCcpO1xuICAgICAgICBpZiAoIWlucHV0LnZhbHVlKSByZXR1cm47XG4gICAgICAgIF9kcmF3QWxsVGFza3NJblByb2plY3QoKTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgc2hvd0xhc3RJdGVtKCk7XG4gICAgICAgIF9yZXNldERhdGUoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzd2l0Y2hQcm9qZWN0KHRhcmdldCkge1xuICAgICAgICBsZXQgY3VycmVudFByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VsZWN0ZWQnKTtcbiAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9qZWN0LW5hbWUnKTtcbiAgICAgICAgaWYgKGN1cnJlbnRQcm9qZWN0KSBjdXJyZW50UHJvamVjdC5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpO1xuICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTtcbiAgICAgICAgcHJvamVjdFRpdGxlVGV4dC50ZXh0Q29udGVudCA9IHByb2plY3RIYW5kbGVyLmdldEN1cnJlbnRQcm9qZWN0KCk7XG4gICAgICAgIGRlc2NyaXB0aW9uQ29udGFpbmVyKCdoaWRlJyk7XG4gICAgICAgIF9kcmF3QWxsVGFza3NJblByb2plY3QoKTtcbiAgICAgICAgX3Jlc2V0RGF0ZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVByb2plY3QobmFtZSkge1xuICAgICAgICBjb25zdCBsaXN0Q29sdW1uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2xpc3RzLXZpZXcgPiB1bCcpO1xuXG4gICAgICAgIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICBsaXN0LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QnKTtcbiAgICAgICAgbGlzdC5pbm5lclRleHQgPSBuYW1lO1xuICAgICAgICBsaXN0LnNldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJywgbmFtZSk7XG4gICAgICAgIGxpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gcHJvamVjdEhhbmRsZXIuc3dpdGNoUHJvamVjdChlKSk7XG5cbiAgICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgc3Bhbi5jbGFzc0xpc3QuYWRkKCdyZW1vdmUtbGlzdCcpO1xuICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJywgbmFtZSk7XG4gICAgICAgIHNwYW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZW1vdmVQcm9qZWN0KTtcblxuICAgICAgICBjb25zdCByZW1vdmVMaXN0SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICAgICAgcmVtb3ZlTGlzdEljb24uc2V0QXR0cmlidXRlKCdjbGFzcycsICdmYXMgZmEtdGltZXMtY2lyY2xlJyk7XG5cbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3LWxpc3QtaW5wdXQnKTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XG5cbiAgICAgICAgY29uc3QgYWRkTGlzdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXctbGlzdCcpO1xuICAgICAgICBhZGRMaXN0QnRuLmNsYXNzTGlzdC50b2dnbGUoJ2FkZC1saXN0LWZvY3VzJyk7XG5cbiAgICAgICAgc3Bhbi5hcHBlbmRDaGlsZChyZW1vdmVMaXN0SWNvbik7XG4gICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoc3Bhbik7XG5cbiAgICAgICAgbGlzdENvbHVtbi5hcHBlbmRDaGlsZChsaXN0KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVQcm9qZWN0KCkge1xuICAgICAgICBsZXQgcHJvamVjdE5hbWUgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1uYW1lJyk7XG4gICAgICAgIGxldCBsaXN0VG9SZW1vdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBsaVtkYXRhLW5hbWU9JyR7cHJvamVjdE5hbWV9J11gKTtcbiAgICAgICAgbGlzdFRvUmVtb3ZlLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8vIEVyYXNlcyBvbGQgdGFza3MsIHRoZW4gZHJhd3MgYWxsIHRoZSB0YXNrcyBpbiB0aGUgc2VsZWN0ZWQgcHJvamVjdFxuICAgIGZ1bmN0aW9uIF9kcmF3QWxsVGFza3NJblByb2plY3QoKSB7XG4gICAgICAgIGNvbnN0IHRhc2tDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza3MtY29udGFpbmVyJyk7XG4gICAgICAgIHRhc2tDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XG5cbiAgICAgICAgbGV0IGFycmF5TGVuZ3RoID0gcHJvamVjdEhhbmRsZXIuZ2V0UHJvamVjdEFycmF5TGVuZ3RoKCk7XG5cbiAgICAgICAgaWYgKCFhcnJheUxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgdGFza0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrcy1jb250YWluZXInKTtcbiAgICAgICAgICAgIGxldCBpdGVtRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBpdGVtRGl2LmNsYXNzTGlzdC5hZGQoJ3Rhc2staXRlbScpO1xuICAgICAgICAgICAgaXRlbURpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnLCBpKTtcblxuICAgICAgICAgICAgbGV0IGlucHV0Q2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAgICAgaW5wdXRDaGVja2JveC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnY2hlY2tib3gnKTtcbiAgICAgICAgICAgIGlucHV0Q2hlY2tib3guc2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JywgaSk7XG4gICAgICAgICAgICBpZiAocHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpKS5jb21wbGV0ZWQgPT09ICd5ZXMnKSB7XG4gICAgICAgICAgICAgICAgaW5wdXRDaGVja2JveC5zZXRBdHRyaWJ1dGUoJ2NoZWNrZWQnLCAnJyk7XG4gICAgICAgICAgICAgICAgaXRlbURpdi5jbGFzc0xpc3QuYWRkKCdjb21wbGV0ZS10YXNrJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlucHV0Q2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcpO1xuICAgICAgICAgICAgICAgIGxldCB0YXNrSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYGRpdltkYXRhLWluZGV4PScke2luZGV4fSddYCk7XG4gICAgICAgICAgICAgICAgdGFza0l0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnY29tcGxldGUtdGFzaycpO1xuICAgICAgICAgICAgICAgIGlmIChwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGluZGV4KS5jb21wbGV0ZWQgPT09ICd5ZXMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RIYW5kbGVyLmdldEl0ZW0oaW5kZXgpLmNvbXBsZXRlZCA9ICdubyc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpbmRleCkuY29tcGxldGVkID0gJ3llcyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJcyB0aGUgaXRlbSBjb21wbGV0ZWQ6ICcgKyBwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGluZGV4KS5jb21wbGV0ZWQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBwVGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICAgICAgICBwVGl0bGUudGV4dENvbnRlbnQgPSBwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGkpLnRpdGxlO1xuICAgICAgICAgICAgcFRpdGxlLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcsIGkpO1xuXG4gICAgICAgICAgICBsZXQgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcbiAgICAgICAgICAgIGljb24uc2V0QXR0cmlidXRlKCdjbGFzcycsICdmYXMgZmEtdGltZXMnKTtcbiAgICAgICAgICAgIGljb24uc2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JywgaSk7XG4gICAgICAgICAgICBpY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgX3JlbW92ZUl0ZW0pO1xuXG4gICAgICAgICAgICBpdGVtRGl2LmFwcGVuZENoaWxkKGlucHV0Q2hlY2tib3gpO1xuICAgICAgICAgICAgaXRlbURpdi5hcHBlbmRDaGlsZChwVGl0bGUpO1xuICAgICAgICAgICAgaXRlbURpdi5hcHBlbmRDaGlsZChpY29uKTtcblxuICAgICAgICAgICAgaXRlbURpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiBzZXREZXRhaWxzKGUpKTtcbiAgICAgICAgICAgIGl0ZW1EaXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHRvUmVtb3ZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhpZ2hsaWdodC10YXNrJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRvUmVtb3ZlKSB0b1JlbW92ZS5jbGFzc0xpc3QudG9nZ2xlKCdoaWdobGlnaHQtdGFzaycpO1xuICAgICAgICAgICAgICAgIGl0ZW1EaXYuY2xhc3NMaXN0LnRvZ2dsZSgnaGlnaGxpZ2h0LXRhc2snKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0YXNrQ29udGFpbmVyLmFwcGVuZENoaWxkKGl0ZW1EaXYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVzY3JpcHRpb25Db250YWluZXIoYWN0aW9uLCBpbmRleCkge1xuICAgICAgICBsZXQgZGVzY3JpcHRpb25QYW5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJyk7XG4gICAgICAgIGxldCBkZWZhdWx0Tm9UYXNrVmlldyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduby10YXNrLWRlZmF1bHQtdmlldycpO1xuICAgICAgICBpZiAoYWN0aW9uID09PSAnaGlkZScpIHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uUGFuZS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIGRlZmF1bHROb1Rhc2tWaWV3LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb24gPT09ICdzaG93Jykge1xuICAgICAgICAgICAgZGVzY3JpcHRpb25QYW5lLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgICAgICAgZGVzY3JpcHRpb25QYW5lLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmRleC1hcnJheScsIGAke2luZGV4fWApO1xuICAgICAgICAgICAgZGVmYXVsdE5vVGFza1ZpZXcuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXREZXRhaWxzKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC50YXJnZXQudGFnTmFtZSA9PT0gJ0lOUFVUJyB8fCBldmVudC50YXJnZXQudGFnTmFtZSA9PT0gJ0knKSByZXR1cm47XG4gICAgICAgIGxldCBpbmRleCA9IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnKTtcbiAgICAgICAgbGV0IHRleHRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKTtcbiAgICAgICAgbGV0IHRpdGxlVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbi10aXRsZSA+IGlucHV0Jyk7XG4gICAgICAgIGNvbnN0IGRhdGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9ZGF0ZV0nKTtcbiAgICAgICAgdGl0bGVUZXh0LnZhbHVlID0gcHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpbmRleCkudGl0bGU7XG4gICAgICAgIGRlc2NyaXB0aW9uQ29udGFpbmVyKCdzaG93JywgaW5kZXgpO1xuICAgICAgICBkYXRlSW5wdXQuc2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JywgaW5kZXgpO1xuICAgICAgICBpZiAoIXByb2plY3RIYW5kbGVyLmdldEl0ZW0oaW5kZXgpLmRlc2NyaXB0aW9uKSB0ZXh0QXJlYS52YWx1ZSA9ICcnO1xuICAgICAgICBpZiAocHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpbmRleCkuZGVzY3JpcHRpb24pIHRleHRBcmVhLnZhbHVlID0gcHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpbmRleCkuZGVzY3JpcHRpb247XG4gICAgICAgIGlmICghcHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpbmRleCkuZGF0ZSkgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgIGlmIChwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGluZGV4KS5kYXRlKSBkYXRlSW5wdXQudmFsdWUgPSBwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGluZGV4KS5kYXRlO1xuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGluZGV4KS5kYXRlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzaG93TGFzdEl0ZW0oKSB7XG4gICAgICAgIGxldCBpbmRleCA9IHByb2plY3RIYW5kbGVyLmdldFByb2plY3RBcnJheUxlbmd0aCgpIC0gMTtcbiAgICAgICAgbGV0IHRleHRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKTtcbiAgICAgICAgbGV0IHRpdGxlVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbi10aXRsZSA+IGlucHV0Jyk7XG4gICAgICAgIGxldCBkYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1kYXRlXScpO1xuICAgICAgICBkYXRlLnNldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcsIGluZGV4KTtcbiAgICAgICAgdGl0bGVUZXh0LnZhbHVlID0gcHJvamVjdEhhbmRsZXIuZ2V0SXRlbShpbmRleCkudGl0bGU7XG4gICAgICAgIGRlc2NyaXB0aW9uQ29udGFpbmVyKCdzaG93JywgaW5kZXgpO1xuICAgICAgICBpZiAoIXByb2plY3RIYW5kbGVyLmdldEl0ZW0oaW5kZXgpLmRlc2NyaXB0aW9uKSByZXR1cm4gdGV4dEFyZWEudmFsdWUgPSAnJztcbiAgICAgICAgdGV4dEFyZWEudmFsdWUgPSBwcm9qZWN0SGFuZGxlci5nZXRJdGVtKGluZGV4KS5kZXNjcmlwdGlvbjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlZGl0VGl0bGUoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYHBbZGF0YS1pbmRleD0nJHtpbmRleH0nXWApO1xuICAgICAgICB0aXRsZS5pbm5lclRleHQgPSBTdHJpbmcodmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9yZXNldERhdGUoKSB7XG4gICAgICAgIGNvbnN0IGRhdGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9ZGF0ZV0nKTtcbiAgICAgICAgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3JlbW92ZUl0ZW0oKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnKTtcbiAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC50YXNrLWl0ZW1bZGF0YS1pbmRleD0nJHtpbmRleH0nXWApO1xuICAgICAgICBpdGVtLnJlbW92ZSgpO1xuICAgICAgICBwcm9qZWN0SGFuZGxlci5yZW1vdmVJdGVtKGluZGV4KTtcbiAgICAgICAgZGVzY3JpcHRpb25Db250YWluZXIoJ2hpZGUnKTtcbiAgICAgICAgX2RyYXdBbGxUYXNrc0luUHJvamVjdCgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRyYXdBbGxUYXNrcygpIHtcbiAgICAgICAgX2RyYXdBbGxUYXNrc0luUHJvamVjdCgpO1xuICAgIH1cblxuICAgIHJldHVybiB7IGFkZFRhc2ssIHN3aXRjaFByb2plY3QsIGRyYXdBbGxUYXNrcywgZWRpdFRpdGxlLCBzaG93TGFzdEl0ZW0sIGNyZWF0ZVByb2plY3QgfVxufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZGlzcGxheUNvbnRyb2xsZXIiLCJpbXBvcnQgZGlzcGxheUNvbnRyb2xsZXIgZnJvbSAnLi9kaXNwbGF5Q29udHJvbGxlci5qcydcblxuY29uc3QgcHJvamVjdEhhbmRsZXIgPSAoKCkgPT4ge1xuICAgIGxldCBwcm9qZWN0T2JqID0ge1xuICAgICAgICBJbmJveDogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnV2VsY29tZSB0byBUb2RvJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1RoaXMgaXMgYSBkZWZhdWx0IGRlc2NyaXB0aW9uLCBlZGl0IG1lIScsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnV2hhdCBjYW4geW91IGRvIHdpdGggVG9kbz8nLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVGhpcyBpcyBhbm90aGVyIGRlZmF1bHQgZGVzY3JpcHRpb24uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdDaGVjayBvdXQgbXkgR2l0aHViJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpbmQgbWUgQHdpbm55dHAnLFxuICAgICAgICAgICAgfVxuICAgICAgICBdLFxuXG4gICAgICAgICdFeGFtcGxlIExpc3QnOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGl0bGU6ICdUaGlzIGlzIGFuIGV4YW1wbGUgdGl0bGUnLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVGhpcyBpcyBhbiBleGFtcGxlIGRlc2NyaXB0aW9uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG5cbiAgICB9XG5cbiAgICBsZXQgX2N1cnJlbnRQcm9qZWN0TmFtZSA9ICdJbmJveCc7XG4gICAgbGV0IF9jdXJyZW50UHJvamVjdCA9IHByb2plY3RPYmpbYCR7X2N1cnJlbnRQcm9qZWN0TmFtZX1gXTtcblxuICAgIGZ1bmN0aW9uIHRhc2sodGl0bGUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSwgY29tcGxldGVkKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSB7fTtcbiAgICAgICAgaWYgKHRpdGxlKSB0YXNrLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRhc2suZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgdGFzay5kYXRlID0gZGF0ZTtcbiAgICAgICAgdGFzay5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICB0YXNrLmNvbXBsZXRlZCA9IGNvbXBsZXRlZDtcbiAgICAgICAgcmV0dXJuIHRhc2s7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbmV3VGFzaygpIHtcbiAgICAgICAgbGV0IHByb2plY3QgPSBwcm9qZWN0T2JqW2Ake19jdXJyZW50UHJvamVjdE5hbWV9YF07XG4gICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2staW5wdXQnKTtcbiAgICAgICAgaWYgKCFpbnB1dC52YWx1ZSkgcmV0dXJuO1xuICAgICAgICBwcm9qZWN0LnB1c2godGFzayhpbnB1dC52YWx1ZSkpO1xuICAgICAgICBjb25zb2xlLnRhYmxlKHByb2plY3QpO1xuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5hZGRUYXNrKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWRkUHJvamVjdCgpIHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3LWxpc3QtaW5wdXQnKTtcbiAgICAgICAgbGV0IG5hbWUgPSBpbnB1dC52YWx1ZTtcbiAgICAgICAgcHJvamVjdE9ialtgJHtuYW1lfWBdID0gW107XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RPYmpbYCR7bmFtZX1gXSk7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmNyZWF0ZVByb2plY3QobmFtZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlRGVmYXVsdEluYm94KCkge1xuICAgICAgICBsZXQgcHJvamVjdCA9IHByb2plY3RPYmpbJ0luYm94J107XG4gICAgICAgIHByb2plY3QucHVzaCh0YXNrKCdXZWxjb21lIHRvIFRvZG8nLCBgVGhpcyBpcyBhIGRlZmF1bHQgZGVzY3JpcHRpb24uIEVkaXQgbWUhYCkpO1xuICAgICAgICBwcm9qZWN0LnB1c2godGFzaygnV2hhdCBjYW4geW91IGRvIHdpdGggVG9kbz8nLCBgVGhpcyBpcyBhbm90aGVyIGRlZmF1bHQgZGVzY3JpcHRpb24uYCkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN3aXRjaFByb2plY3QoZXZlbnQpIHtcbiAgICAgICAgbGV0IHRhcmdldCA9IGV2ZW50LnRhcmdldDtcblxuICAgICAgICBfY3VycmVudFByb2plY3QgPSBwcm9qZWN0T2JqW2Ake3RhcmdldC50ZXh0Q29udGVudH1gXTtcblxuICAgICAgICBpZiAoIV9jdXJyZW50UHJvamVjdCkgcmV0dXJuO1xuXG4gICAgICAgIF9jdXJyZW50UHJvamVjdE5hbWUgPSB0YXJnZXQudGV4dENvbnRlbnQ7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1N3aXRjaGVkIHRvOiAnICsgX2N1cnJlbnRQcm9qZWN0TmFtZSk7XG4gICAgICAgIGNvbnNvbGUudGFibGUoX2N1cnJlbnRQcm9qZWN0KTtcblxuICAgICAgICBkaXNwbGF5Q29udHJvbGxlci5zd2l0Y2hQcm9qZWN0KHRhcmdldCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZURlc2NyaXB0aW9uKCkge1xuICAgICAgICBsZXQgZGVzY3JpcHRpb25QYW5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJyk7XG4gICAgICAgIGxldCBhcnJheUluZGV4ID0gZGVzY3JpcHRpb25QYW5lLmdldEF0dHJpYnV0ZSgnZGF0YS1pbmRleC1hcnJheScpO1xuICAgICAgICBsZXQgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJyk7XG4gICAgICAgIGlmICghYXJyYXlJbmRleCkgcmV0dXJuO1xuICAgICAgICBfY3VycmVudFByb2plY3RbYXJyYXlJbmRleF0uZGVzY3JpcHRpb24gPSBjb250ZW50LnZhbHVlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNhdmVUaXRsZSgpIHtcbiAgICAgICAgbGV0IGluZGV4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlc2NyaXB0aW9uJykuZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4LWFycmF5Jyk7XG4gICAgICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbi10aXRsZSA+IGlucHV0JykudmFsdWU7XG4gICAgICAgIGRpc3BsYXlDb250cm9sbGVyLmVkaXRUaXRsZShpbmRleCwgdGl0bGUpO1xuICAgICAgICBfY3VycmVudFByb2plY3RbaW5kZXhdLnRpdGxlID0gdGl0bGU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2F2ZURhdGUoKSB7XG4gICAgICAgIGxldCBpbmRleCA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4Jyk7XG4gICAgICAgIGNvbnN0IGRhdGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9ZGF0ZV0nKTtcbiAgICAgICAgX2N1cnJlbnRQcm9qZWN0W2luZGV4XS5kYXRlID0gZGF0ZUlucHV0LnZhbHVlO1xuICAgICAgICBjb25zb2xlLmxvZyhkYXRlSW5wdXQudmFsdWUgKyAnIHdhcyBzYXZlZCBpbiAnICsgX2N1cnJlbnRQcm9qZWN0TmFtZSArICcgKGluZGV4OiAnICsgaW5kZXggKyAnKScpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRQcm9qZWN0KCkge1xuICAgICAgICByZXR1cm4gX2N1cnJlbnRQcm9qZWN0TmFtZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBnZXRJdGVtKHBvc2l0aW9uKSB7XG4gICAgICAgIGxldCBwcm9qZWN0ID0gcHJvamVjdE9ialtgJHtfY3VycmVudFByb2plY3ROYW1lfWBdO1xuICAgICAgICBsZXQgdGhpc0l0ZW0gPSBwcm9qZWN0W3Bvc2l0aW9uXTtcbiAgICAgICAgcmV0dXJuIHRoaXNJdGVtO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlbW92ZUl0ZW0oaSkge1xuICAgICAgICBfY3VycmVudFByb2plY3Quc3BsaWNlKGksIDEpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGdldFByb2plY3RBcnJheUxlbmd0aCgpIHtcbiAgICAgICAgbGV0IHByb2plY3RBcnJheUxlbmd0aCA9IHByb2plY3RPYmpbYCR7X2N1cnJlbnRQcm9qZWN0TmFtZX1gXS5sZW5ndGg7XG4gICAgICAgIHJldHVybiBwcm9qZWN0QXJyYXlMZW5ndGg7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgbmV3VGFzayxcbiAgICAgICAgICAgIHN3aXRjaFByb2plY3QsXG4gICAgICAgICAgICBhZGRQcm9qZWN0LFxuICAgICAgICAgICAgZ2V0Q3VycmVudFByb2plY3QsIFxuICAgICAgICAgICAgZ2V0SXRlbSwgXG4gICAgICAgICAgICBnZXRQcm9qZWN0QXJyYXlMZW5ndGgsXG4gICAgICAgICAgICBjcmVhdGVEZWZhdWx0SW5ib3gsXG4gICAgICAgICAgICBzYXZlRGVzY3JpcHRpb24sXG4gICAgICAgICAgICBzYXZlVGl0bGUsXG4gICAgICAgICAgICBzYXZlRGF0ZSxcbiAgICAgICAgICAgIHJlbW92ZUl0ZW0sXG4gICAgICAgIH1cbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IHByb2plY3RIYW5kbGVyIiwiY29uc29sZS5sb2coJ1RvZG8gQXBwJyk7XG5cbmltcG9ydCBwcm9qZWN0SGFuZGxlciBmcm9tICcuL3Byb2plY3RIYW5kbGVyLmpzJ1xuaW1wb3J0IGRpc3BsYXlDb250cm9sbGVyIGZyb20gJy4vZGlzcGxheUNvbnRyb2xsZXIuanMnXG5cbi8vIEV2ZW50IExpc3RlbmVyc1xuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkZC10YXNrLWJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcHJvamVjdEhhbmRsZXIubmV3VGFzaygpKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0YXNrLWlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICBwcm9qZWN0SGFuZGxlci5uZXdUYXNrKCk7XG4gICAgfVxufSk7XG5cbmxldCBwcm9qZWN0QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9qZWN0Jyk7XG5wcm9qZWN0QnRucy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4gcHJvamVjdEhhbmRsZXIuc3dpdGNoUHJvamVjdChldmVudCkpO1xufSk7XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcHJvamVjdEhhbmRsZXIuc2F2ZURlc2NyaXB0aW9uKTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZXNjcmlwdGlvbi10aXRsZSA+IGlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgcHJvamVjdEhhbmRsZXIuc2F2ZVRpdGxlKTtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9ZGF0ZV0nKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBwcm9qZWN0SGFuZGxlci5zYXZlRGF0ZSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3LWxpc3QnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCBsaXN0SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV3LWxpc3QtaW5wdXQnKTtcbiAgICBsaXN0SW5wdXQuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XG4gICAgY29uc3QgbmV3TGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXctbGlzdCcpXG4gICAgbmV3TGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdhZGQtbGlzdC1mb2N1cycpO1xufSlcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ldy1saXN0LWlucHV0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICBwcm9qZWN0SGFuZGxlci5hZGRQcm9qZWN0KCk7XG4gICAgfVxufSk7XG5cbmRpc3BsYXlDb250cm9sbGVyLmNyZWF0ZVByb2plY3QoJ0V4YW1wbGUgTGlzdCcpO1xuZGlzcGxheUNvbnRyb2xsZXIuZHJhd0FsbFRhc2tzKCk7XG5cbi8qIGltcG9ydCBmb3JtYXQgZnJvbSAnLi4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2Zvcm1hdCdcbi8vdG9kYXkncyBkYXRlXG5jb25zdCB0b2RheSA9IGZvcm1hdChuZXcgRGF0ZSgpLCdkZC5NTS55eXl5Jyk7XG5jb25zb2xlLmxvZyh0b2RheSk7ICovIl0sIm5hbWVzIjpbInJlbW92ZVByb2plY3QiLCJwcm9qZWN0TmFtZSIsInRoaXMiLCJnZXRBdHRyaWJ1dGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJyZW1vdmUiLCJfZHJhd0FsbFRhc2tzSW5Qcm9qZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJhcnJheUxlbmd0aCIsImkiLCJ0YXNrQ29udGFpbmVyIiwiaXRlbURpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJpbnB1dENoZWNrYm94IiwiY29tcGxldGVkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJpbmRleCIsInRhcmdldCIsInRvZ2dsZSIsImNvbnNvbGUiLCJsb2ciLCJwVGl0bGUiLCJ0ZXh0Q29udGVudCIsInRpdGxlIiwiaWNvbiIsIl9yZW1vdmVJdGVtIiwiYXBwZW5kQ2hpbGQiLCJzZXREZXRhaWxzIiwidG9SZW1vdmUiLCJkZXNjcmlwdGlvbkNvbnRhaW5lciIsImFjdGlvbiIsImRlc2NyaXB0aW9uUGFuZSIsImRlZmF1bHROb1Rhc2tWaWV3IiwiZXZlbnQiLCJ0YWdOYW1lIiwidGV4dEFyZWEiLCJ0aXRsZVRleHQiLCJkYXRlSW5wdXQiLCJ2YWx1ZSIsImRlc2NyaXB0aW9uIiwiZGF0ZSIsInNob3dMYXN0SXRlbSIsIl9yZXNldERhdGUiLCJhZGRUYXNrIiwiaW5wdXQiLCJzd2l0Y2hQcm9qZWN0IiwiY3VycmVudFByb2plY3QiLCJwcm9qZWN0VGl0bGVUZXh0IiwiZHJhd0FsbFRhc2tzIiwiZWRpdFRpdGxlIiwiaW5uZXJUZXh0IiwiU3RyaW5nIiwiY3JlYXRlUHJvamVjdCIsIm5hbWUiLCJsaXN0Q29sdW1uIiwibGlzdCIsInNwYW4iLCJyZW1vdmVMaXN0SWNvbiIsInByb2plY3RPYmoiLCJJbmJveCIsIl9jdXJyZW50UHJvamVjdE5hbWUiLCJfY3VycmVudFByb2plY3QiLCJ0YXNrIiwicHJpb3JpdHkiLCJuZXdUYXNrIiwicHJvamVjdCIsInB1c2giLCJ0YWJsZSIsImFkZFByb2plY3QiLCJnZXRDdXJyZW50UHJvamVjdCIsImdldEl0ZW0iLCJwb3NpdGlvbiIsImdldFByb2plY3RBcnJheUxlbmd0aCIsImxlbmd0aCIsImNyZWF0ZURlZmF1bHRJbmJveCIsInNhdmVEZXNjcmlwdGlvbiIsImFycmF5SW5kZXgiLCJjb250ZW50Iiwic2F2ZVRpdGxlIiwic2F2ZURhdGUiLCJyZW1vdmVJdGVtIiwic3BsaWNlIiwia2V5IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==